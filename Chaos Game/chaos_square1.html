<!DOCTYPE html>
<html lang ="en">
<head>
<link rel = "stylesheet" href = "chaos.css" >
</head>
<body>
</br></br>
<center>
<font color="white" id="iterno"></font></center>
</center>
<canvas id="canvas" width="1535" height="700"></canvas>
</body>


<script>
var delayInMilliseconds = 0.5; //1 second
var pointSize=3;

var x1=550,x2=950,x3=550,x4=950;
var y1=500,y2=500,y3=100,y4=100;
var x = 600,y=300;
var tx,ty;
var prevdie=-1;
drawCoordinates(x1,y1,4);
drawCoordinates(x2,y2,4);
drawCoordinates(x3,y3,4);
drawCoordinates(x4,y4,4);


(function theLoop (i) {
  setTimeout(function () {
  	
	    drawCoordinates(x,y,2);
   if(i>5)
		document.getElementById('iterno').innerHTML = "iteration #"+(5000-i);
	else
		document.getElementById('iterno').innerHTML = "Drawing final image...";
    var die = Math.floor(Math.random() * 4);
    if(die==0 && prevdie!=3)
    	{
    		x=(x1+x)/2; y=(y+y1)/2;
    		prevdie=0;
    		
    	}
    else if(die==1 && prevdie!=2)
    	{
    		x=(x2+x)/2;y=(y+y2)/2;
    		prevdie=1;
    	}
    else if(die==2 && prevdie!=1)
    	{
    		x=(x3+x)/2;y=(y+y3)/2;
    		prevdie=2;
    	}
    else if(die==3 && prevdie!=0)
    	{
    		x=(x4+x)/2;y=(y+y4)/2;
    		prevdie=3;
    	}
    	

    if (i-=1) {          // If i > 0, keep going
      theLoop(i);       // Call the loop again, and pass it the current value of i
    }
	else
	{
	 drawFinalImage();
	 document.getElementById('iterno').innerHTML = "Image after 50,000 iterations";
	 
	}
	
  },delayInMilliseconds );
})(5000);

function drawFinalImage(){
for(var i=0;i<45000;i++)
{
	drawCoordinates(x,y,2);
    document.getElementById('iterno').innerHTML = "iteration #"+(5000-i);
    var die = Math.floor(Math.random() * 4);
    if(die==0 && prevdie!=3)
    	{
    		x=(x1+x)/2; y=(y+y1)/2;
    		prevdie=0;
    		
    	}
    else if(die==1 && prevdie!=2)
    	{
    		x=(x2+x)/2;y=(y+y2)/2;
    		prevdie=1;
    	}
    else if(die==2 && prevdie!=1)
    	{
    		x=(x3+x)/2;y=(y+y3)/2;
    		prevdie=2;
    	}
    else if(die==3 && prevdie!=0)
    	{
    		x=(x4+x)/2;y=(y+y4)/2;
    		prevdie=3;
    	}
	
}
}


function drawCoordinates(x,y,pointSize){	
  	var ctx = document.getElementById("canvas").getContext("2d");

    // resize the canvas to fill browser window dynamically
    window.addEventListener('resize', resizeCanvas, false);

    function resizeCanvas() {
            //ctx.width = window.innerWidth;
            //ctx.height = window.innerHeight;

            /**
             * Your drawings need to be inside this function otherwise they will be reset when 
             * you resize the browser window and the canvas goes will be cleared.
             */
           ctx.fillStyle = "#ff2626"; // Red color

    ctx.beginPath();
    ctx.fillStyle="blue";
    ctx.arc(x, y, pointSize, 0, Math.PI * 2, true);
    ctx.fill();
    //ctx.fillRect(x,y,1,1);
    }
    resizeCanvas();
  	
}
</script>
</html>
